概率动态规划, 字符串处理, 动态规划, 分数运算, 组合计数, 自动机模型, 状态转移, 重叠子问题, 最大重叠计算, 期望值计算, 概率论, 条件概率, 字符串拼接, 递推关系, 模运算, 递归关系, 数学期望, 哈希处理, 前缀和优化