动态规划, 计数dp, 字符串处理, 组合数学, 模运算, 快速幂, 前缀和, 字符串哈希, 数学推导, 预处理, 数组处理, 状态转移优化, 子串统计, 大数取模, 概率计算, 递推公式, 分情况讨论, 边界条件处理, 时间复杂度优化, 空间复杂度优化